package com.hanwang.web.controller;import com.hanwang.web.PO.UserPO;import com.hanwang.web.entity.User;import com.hanwang.web.mapper.UserMapper;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Controller;import org.springframework.ui.Model;import org.springframework.web.bind.annotation.*;import org.springframework.web.multipart.MultipartFile;import pub.gadfly.sdk.Utils.RSA;import java.io.IOException;import java.util.ArrayList;import java.util.List;import java.util.Map;@Controller@RequestMapping("/user")public class UserController {	@Autowired	private UserMapper userMapper;	@RequestMapping(value="", method= RequestMethod.GET)	public String index(Model model){		List<UserPO> userList = new ArrayList<>();		userMapper.selectList( null ).forEach( (user) -> {			UserPO userPO = new UserPO();			userPO.setEmail(user.getEmail());			userPO.setRealname(user.getRealname());			userPO.setMobile(user.getMobile());			userPO.setId(user.getId());			if(user.getHeadPic()!=null){				userPO.setHeadPic(user.getHeadPic());			}			userList.add(userPO);		} );		model.addAttribute("userList", userList);		return "user/index";	}	@RequestMapping(value = "/addUser", method = RequestMethod.GET)	public String addUser(){		return "user/addUser";	}	@RequestMapping(value = "/addUser", method = RequestMethod.POST)	public String addUser(			@RequestParam("realname") String realname,			@RequestParam("mobile") String mobile,			@RequestParam("email") String email	){		System.out.println("realname: " + realname + ", mobile: " + mobile + ", email: " + email);		User user = new User();		user.setEmail( email );		user.setRealname( realname );		user.setMobile( mobile );		_register(user);		return "redirect:/user";	}	@RequestMapping(value = "/register", method = RequestMethod.GET)	public String register(Model model){		model.addAttribute("user", new User());		return "user/register";	}	@RequestMapping(value = "/register", method = RequestMethod.POST)	public String register(@ModelAttribute User user, @RequestParam("file") MultipartFile file){		try {			user.setHeadPic(file.getBytes());		} catch (IOException e) {			e.printStackTrace();		} catch (Exception e) {			e.printStackTrace();		}		System.out.println(user.toString());		_register(user);		return "redirect:/user";	}	private void _register(User user){		try {			Map<String, Object> genKeyPair = RSA.genKeyPair();			user.setPrivateKey( RSA.getPrivateKey(genKeyPair) );			user.setPublicKey( RSA.getPublicKey(genKeyPair) );			user.insert();		} catch (Exception e) {			e.printStackTrace();		}	}}